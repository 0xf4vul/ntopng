Metrics
#######

Here is the full list of metrics exported as timeseries by ntopng.

There are two types of metrics exported by ntiong currently: **counters** and **gauges**. 

- **counters** are used for continuous incrementing metrics such as the total number of bytes.
- **gauges** are used for metrics such as the number of active flows or active hosts at a certain point in time.


Device Metrics
==============


.. admonition:: mac:traffic
   
   Total number of bytes sent and received by a L2 device.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | mac                      | MAC address                                               |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: mac:arp_rqst_sent_rcvd_rpls
   
   Total ARP requests sent and replies received by a L2 device.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | mac                      | MAC address                                               |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | request_packets_sent     | ARP requests sent.                                        |
   +--------------------------+-----------------------------------------------------------+
   | reply_packets_rcvd       | ARP replies received.                                     |
   +--------------------------+-----------------------------------------------------------+
   

.. admonition:: mac:ndpi_categories
   
   Total number of bytes per category (nDPI) for a L2 device.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | mac                      | MAC address                                               |
   +--------------------------+-----------------------------------------------------------+
   | category                 | Application protocol category (nDPI)                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes                    | Bytes.                                                    |
   +--------------------------+-----------------------------------------------------------+


Host Metrics
============


.. admonition:: host:traffic
   
   Total number of bytes sent and received by an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:active_flows
   
   Number of active flows for an host.
   
   - **Type**: gauge
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_client          | Number of flows with the host as client.                  |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_server          | Number of flows with the host as server.                  |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:total_flows
   
   Total number of flows for an host.
   
   - **Type**: counter 
   
   **Tags**

   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_client          | Total number of flows with the host as client.            |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_server          | Total number of flows with the host as server.            |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:misbehaving_flows
   
   Total number of misbehaving flows for an host.
   
   - **Type**: counter 
   
   **Tags**

   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_client          | Total number of misbehaving flows with the host as client.|
   +--------------------------+-----------------------------------------------------------+
   | flows_as_server          | Total number of misbehaving flows with the host as server.|
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:unreachable_flows
   
   Total number of ICMP Port Unreachable flows for an host.
   
   - **Type**: counter 
   
   **Tags**

   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_client          | Total number of ICMP Port Unreachable flows with the host |
   |                          | as client.                                                |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_server          | Total number of ICMP Port Unreachable flows with the host |
   |                          | as server.                                                |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:host_unreachable_flows
   
   Total number of ICMP Host Unreachable flows for an host.
   
   - **Type**: counter 
   
   **Tags**

   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_client          | Total number of ICMP Host Unreachable flows with the host |
   |                          | as client.                                                |
   +--------------------------+-----------------------------------------------------------+
   | flows_as_server          | Total number of ICMP Host Unreachable flows with the host |
   |                          | as server.                                                |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:ndpi_flows
   
   Total number of flows per application protocol (nDPI) for an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+
   | protocol                 | Application protocol (nDPI)                               |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | num_flows                | Total number of flows.                                    |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:echo_packets
   
   Total number of ICMP Echo packets sent and received by an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | packets_sent             | Total number of ICMP Echo packets sent by the host.       |
   +--------------------------+-----------------------------------------------------------+
   | packets_rcvd             | Total number of ICMP Echo packets received by the host.   |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:echo_reply_packets
   
   Total number of ICMP Echo Reply packets sent and received by an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | packets_sent             | Total number of ICMP Echo Reply packets sent by the host. |
   +--------------------------+-----------------------------------------------------------+
   | packets_rcvd             | Total number of ICMP Echo Reply packets received by the   |
   |                          | host.                                                     |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:dns_qry_sent_rsp_rcvd
   
   Total number of DNS queries sent and replies received by an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | queries_packets          | Total number of DNS queries.                              |
   +--------------------------+-----------------------------------------------------------+
   | replies_ok_packets       | Total number of DNS replies with no errors.               |
   +--------------------------+-----------------------------------------------------------+
   | replies_error_packets    | Total number of DNS replies with errors.                  |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:dns_qry_rcvd_rsp_sent
   
    Total number of DNS queries received and replies sent by an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | queries_packets          | Total number of DNS queries.                              |
   +--------------------------+-----------------------------------------------------------+
   | replies_ok_packets       | Total number of DNS replies with no errors.               |
   +--------------------------+-----------------------------------------------------------+
   | replies_error_packets    | Total number of DNS replies with errors.                  |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:tcp_rx_stats
   
   Total number of retransmitted, Out-Of-Order and lost TCP packets received by an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | retransmission_packets   | Total number of retransmitted packets.                    |
   +--------------------------+-----------------------------------------------------------+
   | out_of_order_packets     | Total number of Out-Of-Order packets.                     |
   +--------------------------+-----------------------------------------------------------+
   | lost_packets             | Total number of lost packets.                             |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:tcp_tx_stats
   
   Total number of retransmitted, Out-Of-Order and lost TCP packets sent by an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | retransmission_packets   | Total number of retransmitted packets.                    |
   +--------------------------+-----------------------------------------------------------+
   | out_of_order_packets     | Total number of Out-Of-Order packets.                     |
   +--------------------------+-----------------------------------------------------------+
   | lost_packets             | Total number of lost packets.                             |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:tcp_packets
   
   Total number of TCP packets sent and received by the host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | packets_sent             | Total number of TCP packets sent.                         |
   +--------------------------+-----------------------------------------------------------+
   | packets_rcvd             | Total number of TCP packets received.                     |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:udp_pkts
   
   Total number of UDP packets sent and received by the host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | packets_sent             | Total number of UDP packets sent.                         |
   +--------------------------+-----------------------------------------------------------+
   | packets_rcvd             | Total number of UDP packets received.                     |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:total_alerts
   
   Total number of alerts generated by the host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | alerts                   | Total number of alerts.                                   |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:contacts
   
   Total number of contacts/peers with the host as client or server.
   
   - **Type**: gauge 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | num_as_client            | Total number of contacts with the host as client.         |
   +--------------------------+-----------------------------------------------------------+
   | num_as_server            | Total number of contacts with the host as server.         |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:l4protos
   
   Total number of bytes sent and received by L4 protocol for an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host:udp_sent_unicast
   
   Total number of bytes sent by the host for unicast and non unicast traffic.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_sent_unicast       | Bytes sent (unicast).                                     |
   +--------------------------+-----------------------------------------------------------+
   | bytes_sent_non_unicast   | Bytes sent (non unicast).                                 |
   +--------------------------+-----------------------------------------------------------+
   
   
.. admonition:: host:ndpi
   
   Total number of bytes sent and received per application protocol (nDPI) for an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+
   | protocol                 | Application protocol (nDPI)                               |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+
   

.. admonition:: host:ndpi_categories
   
   Total number of bytes sent and received per category (nDPI) for an host.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | host                     | Host                                                      |
   +--------------------------+-----------------------------------------------------------+
   | category                 | Application protocol category (nDPI)                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


VLAN Metrics
============


.. admonition:: vlan:traffic
   
   Total number of bytes sent and received for a VLAN.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | vlan                     | VLAN ID                                                   |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: vlan:ndpi
   
   Total number of bytes sent and received per application protocol (nDPI) for a VLAN.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | vlan                     | VLAN ID                                                   |
   +--------------------------+-----------------------------------------------------------+
   | protocol                 | Application protocol (nDPI)                               |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


SNMP Interface Metrics
======================

.. admonition:: snmp_if:traffic
   
   
   Total number of bytes sent and received by a SNMP interface.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | device                   | SNMP device                                               |
   +--------------------------+-----------------------------------------------------------+
   | if_index                 | SNMP interface index                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: snmp_if:errors
   
   
   Total number of packets discarded or with errors on a SNMP interface.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | device                   | SNMP device                                               |
   +--------------------------+-----------------------------------------------------------+
   | if_index                 | SNMP interface index                                      |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | packets_disc             | Total number of discarded packets.                        |
   +--------------------------+-----------------------------------------------------------+
   | packets_err              | Total number of packets with errors.                      |
   +--------------------------+-----------------------------------------------------------+


Host Pool Metrics
=================


.. admonition:: host_pool:traffic
   
   Total number of bytes sent and received by an host pool.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | pool                     | Host Pool                                                 |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host_pool:hosts
   
   Number of hosts in an host pool.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | pool                     | Host Pool                                                 |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | num_hosts                | Number of hosts.                                          |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: host_pool:devices
   
   Number of devices in an host pool.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | pool                     | Host Pool                                                 |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | num_devices              | Number of devices.                                        |
   +--------------------------+-----------------------------------------------------------+
   

.. admonition:: host_pool:blocked_flows
   
   Total number of blocked flows for an host pool.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | pool                     | Host Pool                                                 |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | num_flows                | Number of blocked flows.                                  |
   +--------------------------+-----------------------------------------------------------+
   

.. admonition:: host_pool:ndpi
   
   Total number of bytes sent and received per application protocol (nDPI) for an host pool.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | pool                     | Host Pool                                                 |
   +--------------------------+-----------------------------------------------------------+
   | protocol                 | Application protocol (nDPI)                               |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


ASN Metrics
===========


.. admonition:: asn:traffic
   
   Total number of bytes sent and received by an AS.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | asn                      | ASN (Autonomous System Number)                            |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: asn:ndpi
   
   Total number of bytes sent and received per application protocol (nDPI) by an AS.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | asn                      | ASN (Autonomous System Number)                            |
   +--------------------------+-----------------------------------------------------------+
   | protocol                 | Application protocol (nDPI)                               |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_sent               | Bytes sent.                                               |
   +--------------------------+-----------------------------------------------------------+
   | bytes_rcvd               | Bytes received.                                           |
   +--------------------------+-----------------------------------------------------------+
   

.. admonition:: asn:rtt
   
   Round Trip Time for an AS, computed as exponentially weighted moving average.
   
   - **Type**: gauge 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | asn                      | ASN (Autonomous System Number)                            |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | millis_rtt               | Round Trip Time                                           |
   +--------------------------+-----------------------------------------------------------+
   

.. admonition:: asn:tcp_retransmissions
   
   Total number of retransmitted TCP packets from/to an AS.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | asn                      | ASN (Autonomous System Number)                            |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | packets_sent             | Retransmitted packets from the AS.                        |
   +--------------------------+-----------------------------------------------------------+
   | packets_rcvd             | Retransmitted packets to the AS.                          |
   +--------------------------+-----------------------------------------------------------+
   

.. admonition:: asn:tcp_out_of_order
   
   Total number of Out Of Order TCP packets from/to an AS.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | asn                      | ASN (Autonomous System Number)                            |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | packets_sent             | Out Of Order packets from the AS.                         |
   +--------------------------+-----------------------------------------------------------+
   | packets_rcvd             | Out Of Order packets to the AS.                           |
   +--------------------------+-----------------------------------------------------------+
   

.. admonition:: asn:tcp_lost
   
   Total number of lost TCP packets from/to an AS.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | asn                      | ASN (Autonomous System Number)                            |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | packets_sent             | Lost packets from the AS.                                 |
   +--------------------------+-----------------------------------------------------------+
   | packets_rcvd             | Lost packets to the AS.                                   |
   +--------------------------+-----------------------------------------------------------+


.. admonition:: asn:tcp_keep_alive
   
   Total number of TCP Keepalives packets from/to an AS.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | asn                      | ASN (Autonomous System Number)                            |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | packets_sent             | TCP Keepalives packets from the AS.                       |
   +--------------------------+-----------------------------------------------------------+
   | packets_rcvd             | TCP Keepalives packets to the AS.                         |
   +--------------------------+-----------------------------------------------------------+
 

Country Metrics
===============


.. admonition:: country:traffic
   
   Total number of ingress/egress/inner bytes for a country.
   
   - **Type**: counter 
   
   **Tags**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | ifid                     | Interface index                                           |
   +--------------------------+-----------------------------------------------------------+
   | country                  | Country                                                   |
   +--------------------------+-----------------------------------------------------------+

   **Fields**
   
   +--------------------------+-----------------------------------------------------------+
   | Name                     | Description                                               |
   +==========================+===========================================================+
   | bytes_ingress            | Country ingress bytes.                                    |
   +--------------------------+-----------------------------------------------------------+
   | bytes_egress             | Country egress bytes.                                     |
   +--------------------------+-----------------------------------------------------------+
   | bytes_inner              | Country inner bytes.                                      |
   +--------------------------+-----------------------------------------------------------+
   
   